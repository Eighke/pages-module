{% macro links(pages, collection, active, options) %}
    {% for page in pages %}
        <li class="
            {{ collection.children(page.getObject()).isEmpty() ? '' : 'has-children' }}
            {{ collection.children(page.getObject()).find(active.id) ? (options.has_active_class ?: 'has-active') }}
            {{ page.id == active.id ? (options.active_class ?: 'active') }}
            {{ options.item_class }}
            ">
            <a href="{{ url(page.path) }}">
                {{ page.title }}
            </a>

            {% if not collection.children(page.getObject()).isEmpty() %}
                <ul class="{{ options.child_list_class }}">
                    {{ _self.links(collection.children(page.getObject()), collection, active, options) }}
                </ul>
            {% endif %}
        </li>
    {% endfor %}
{% endmacro %}
